
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instacart Reorder Prediction - Performance Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        .metrics-table th {
            background-color: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        .metrics-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }
        .metrics-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .metrics-table tr:hover {
            background-color: #e8f4f8;
        }
        .best-model {
            background-color: #d4edda !important;
            font-weight: bold;
        }
        .metric-highlight {
            color: #27ae60;
            font-weight: bold;
        }
        .section {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .limitation {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .methodology {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #6c757d;
            font-size: 12px;
        }
        .lineage-diagram {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        .flow-stage {
            margin: 15px 0;
            text-align: center;
        }
        .flow-stage h4 {
            margin: 10px 0;
            color: #495057;
            font-size: 16px;
        }
        .flow-arrow {
            text-align: center;
            font-size: 24px;
            color: #6c757d;
            margin: 10px 0;
        }
        .data-sources, .output-files {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin: 10px 0;
        }
        .data-file, .output-file {
            background-color: #e3f2fd;
            color: #1565c0;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-family: monospace;
            border: 1px solid #bbdefb;
        }
        .output-file {
            background-color: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        .process-box, .dataset-box, .training-box {
            background-color: white;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            padding: 12px;
            margin: 10px auto;
            max-width: 400px;
            font-size: 13px;
            line-height: 1.4;
        }
        .process-box {
            border-color: #ffc107;
            background-color: #fff8e1;
        }
        .dataset-box {
            border-color: #17a2b8;
            background-color: #e0f7fa;
        }
        .training-box {
            border-color: #28a745;
            background-color: #e8f5e8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõí Instacart Reorder Prediction - Performance Report</h1>
        
        <div class="section">
            <h2> Projekt √úbersicht</h2>
            <p><strong>Ziel:</strong> Vorhersage welche Produkte ein Kunde in seinem n√§chsten Einkaufskorb wiederholt bestellen wird.</p>
            <p><strong>Ansatz:</strong> End-to-End ML Pipeline mit SQL-basierter Feature Engineering (DuckDB), Multi-Model Training (LogReg/XGBoost/LightGBM) und automatisierter Berichtserstellung.</p>
            <p><strong>Evaluation:</strong> Fokus auf Set-basierte Metriken (Order-F1) die das Business-Ziel widerspiegeln: die richtigen Produkte pro Nutzer vorherzusagen.</p>
        </div>

        <h2>Modell Leaderboard</h2>
        <p>Sortiert nach ROC-AUC (h√∂her = besser). Ziel: ROC-AUC ‚â• 0.83</p>
        
        
    <table class="metrics-table">
        <thead>
            <tr>
                <th>Rang</th>
                <th>Modell</th>
                <th>ROC-AUC</th>
                <th>PR-AUC</th>
                <th>F1@0.5</th>
                <th>Order-F1@top-k</th>
                <th>Top-K</th>
                <th>Training Zeit (s)</th>
                <th>Features</th>
            </tr>
        </thead>
        <tbody>
    
            <tr class="best-model">
                <td>1</td>
                <td><strong>XGB</strong></td>
                <td class="">0.8288</td>
                <td>0.4018</td>
                <td>0.2488</td>
                <td>0.3408</td>
                <td>10</td>
                <td>736.0</td>
                <td>54+2</td>
            </tr>
        
            <tr class="">
                <td>2</td>
                <td><strong>LGBM</strong></td>
                <td class="">0.8279</td>
                <td>0.4012</td>
                <td>0.3719</td>
                <td>0.3407</td>
                <td>10</td>
                <td>618.9</td>
                <td>54+2</td>
            </tr>
        
            <tr class="">
                <td>3</td>
                <td><strong>LOGREG</strong></td>
                <td class="">0.8160</td>
                <td>0.3558</td>
                <td>0.3473</td>
                <td>0.3303</td>
                <td>10</td>
                <td>139.4</td>
                <td>54+2</td>
            </tr>
        
        </tbody>
    </table>
    
        
        <div class="section">
            <h2>Data Lineage & Pipeline Flow</h2>
            <div class="lineage-diagram">
                <div class="flow-stage">
                    <h4>Raw Data Sources</h4>
                    <div class="data-sources">
                        <span class="data-file">orders.csv</span>
                        <span class="data-file">order_products__prior.csv</span>
                        <span class="data-file">order_products__train.csv</span>
                        <span class="data-file">products.csv</span>
                        <span class="data-file">aisles.csv</span>
                        <span class="data-file">departments.csv</span>
                    </div>
                </div>
                
                <div class="flow-arrow">‚¨áÔ∏è</div>
                
                <div class="flow-stage">
                    <h4>Feature Engineering</h4>
                    <div class="process-box">
                        <strong>src/sql/01_build.sql</strong><br>
                        ‚Ä¢ User-product aggregations<br>
                        ‚Ä¢ Temporal recency features<br>
                        ‚Ä¢ Product popularity metrics<br>
                        ‚Ä¢ Categorical lookups<br>
                        ‚Ä¢ Label generation (train only)
                    </div>
                </div>
                
                <div class="flow-arrow"></div>
                
                <div class="flow-stage">
                    <h4>ML-Ready Dataset</h4>
                    <div class="dataset-box">
                        <strong>data/features/features.parquet</strong><br>
                        Schema: user_id, product_id, y, [55+ features]<br>
                        Scale: 6.7M+ training samples
                    </div>
                </div>
                
                <div class="flow-arrow">‚¨áÔ∏è</div>
                
                <div class="flow-stage">
                    <h4>Model Training</h4>
                    <div class="training-box">
                        <strong>src/train.py</strong><br>
                        ‚Ä¢ GroupShuffleSplit (user-based)<br>
                        ‚Ä¢ StandardScaler + OneHotEncoder<br>
                        ‚Ä¢ LogReg / XGBoost / LightGBM<br>
                        ‚Ä¢ Multi-metric evaluation
                    </div>
                </div>
                
                <div class="flow-arrow">‚¨áÔ∏è</div>
                
                <div class="flow-stage">
                    <h4>Performance Reports</h4>
                    <div class="output-files">
                        <span class="output-file">model_*.joblib</span>
                        <span class="output-file">metrics_*.json</span>
                        <span class="output-file">metrics_leaderboard.csv</span>
                        <span class="output-file">report.html</span>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 15px; text-align: center;">
                <p><em>Detailed data lineage documentation available in <code>docs/data_lineage.md</code></em></p>
                <p><strong>Key Transformation Principles:</strong></p>
                <ul style="text-align: left; max-width: 600px; margin: 0 auto;">
                    <li><strong>Temporal Separation:</strong> 'prior' orders ‚Üí features, 'train' orders ‚Üí labels only</li>
                    <li><strong>User-Based Splitting:</strong> GroupShuffleSplit prevents user leakage</li>
                    <li><strong>SQL-First Approach:</strong> DuckDB for efficient CSV processing</li>
                    <li><strong>Comprehensive Features:</strong> 14 engineered features from 6 raw data sources</li>
                    <li><strong>Quality Assurance:</strong> Schema validation and data quality monitoring</li>
                </ul>
            </div>
        </div>

        <div class="methodology">
            <h2>Methodologie</h2>
            <ul>
                <li><strong>Data Leakage Prevention:</strong> Strikte Trennung - 'prior' Orders f√ºr Features, 'train' Orders nur f√ºr Labels</li>
                <li><strong>User-based Splitting:</strong> GroupShuffleSplit verhindert User-Leakage zwischen Train/Validation</li>
                <li><strong>Feature Engineering:</strong> SQL-basiert mit DuckDB f√ºr Effizienz und Transparenz</li>
                <li><strong>Order-F1 Metric:</strong> Set-basierte Evaluation - F1 zwischen vorhergesagten und tats√§chlichen Produktsets pro User</li>
                <li><strong>Preprocessing:</strong> StandardScaler f√ºr numerische Features, OneHotEncoder f√ºr kategorische</li>
            </ul>
        </div>
        
        <div class="limitation">
            <h2>Bekannte Limitationen</h2>
            <ul>
                <li><strong>Cold Start Problem:</strong> Keine Behandlung neuer User oder Produkte ohne Historie</li>
                <li><strong>Simple Thresholding:</strong> F√ºr erste Version bewusst einfache 0.5 Schwelle statt optimierter Thresholds</li>
                <li><strong>Minimal Tuning:</strong> Fokus auf Pipeline-Aufbau, nicht auf Hyperparameter-Optimierung</li>
                <li><strong>Static Features:</strong> Keine zeitabh√§ngigen Features wie Saisonalit√§t oder Trends</li>
                <li><strong>Binary Classification:</strong> Vereinfachung auf Ja/Nein Reorder, keine Mengen-Vorhersage</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>Key Insights</h2>
            <ul>
                <li><strong>Beste Performance:</strong> XGB mit ROC-AUC 0.8288</li>
                <li><strong>Training Effizienz:</strong> LogReg am schnellsten (139.43s), LightGBM guter Kompromiss</li>
                <li><strong>Set-based Evaluation:</strong> Order-F1 zeigt praktische Relevanz f√ºr Business-Anwendung</li>
                <li><strong>Feature Importance:</strong> 54 numerische + 2 kategorische Features</li>
            </ul>
        </div>
    </div>
</body>
</html>

