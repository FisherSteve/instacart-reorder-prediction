2025-09-29 18:52:33,213 - INFO - File logging enabled: reports/logs/__main___build_dataset_20250929_185233.log
2025-09-29 18:52:33,216 - INFO - Memory usage at startup: Process RSS=113.2MB (0.7% of system RAM), System: 3.6GB available (77.6% used)
2025-09-29 18:52:33,216 - INFO - ============================================================
2025-09-29 18:52:33,218 - INFO - INSTACART REORDER PREDICTION - DATASET BUILDER
2025-09-29 18:52:33,219 - INFO - ============================================================
2025-09-29 18:52:33,220 - INFO - Als Lernprojekt bewusst ausf√ºhrlich kommentiert
2025-09-29 18:52:33,220 - INFO - STRUCTURED_METRICS: {"timestamp": "2025-09-29T18:52:33.220771", "context": "build_dataset_config", "metrics": {"sql_file": "src/sql/01_build.sql", "output_file": "data/features/features.parquet", "raw_data_path": "data/raw", "max_users_sampling": null, "skip_validation": false, "skip_quality_checks": false}}
2025-09-29 18:52:33,254 - INFO - Starting input_validation (initial memory: 113.2 MB)
2025-09-29 18:52:33,255 - INFO - Alle ben√∂tigten CSV-Dateien gefunden
2025-09-29 18:52:33,256 - INFO - STRUCTURED_METRICS: {"timestamp": "2025-09-29T18:52:33.256486", "context": "input_file_sizes", "metrics": {"orders.csv": 103.92059803009033, "order_products__prior.csv": 550.7952747344971, "order_products__train.csv": 23.53682231903076, "products.csv": 2.0665674209594727, "aisles.csv": 0.0024824142456054688, "departments.csv": 0.0002574920654296875}}
2025-09-29 18:52:33,256 - INFO - Completed input_validation in 0.00s (memory change: +0.0 MB)
2025-09-29 18:52:33,259 - INFO - Starting schema_validation (initial memory: 113.3 MB)
2025-09-29 18:52:33,259 - INFO - Starte Schema-Validierung der CSV-Dateien...
2025-09-29 18:52:33,259 - INFO -   Validiere data/raw/orders.csv gegen orders Schema...
2025-09-29 18:52:33,271 - INFO -     Geladen: 10000 Zeilen, 7 Spalten
2025-09-29 18:52:33,412 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,439 - INFO -     Null-Werte gefunden:
2025-09-29 18:52:33,469 - INFO -       days_since_prior_order: 633 (6.3%)
2025-09-29 18:52:33,474 - INFO -   Validiere data/raw/products.csv gegen products Schema...
2025-09-29 18:52:33,504 - INFO -     Geladen: 10000 Zeilen, 4 Spalten
2025-09-29 18:52:33,551 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,583 - INFO -   Validiere data/raw/aisles.csv gegen aisles Schema...
2025-09-29 18:52:33,593 - INFO -     Geladen: 134 Zeilen, 2 Spalten
2025-09-29 18:52:33,666 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,686 - INFO -   Validiere data/raw/departments.csv gegen departments Schema...
2025-09-29 18:52:33,718 - INFO -     Geladen: 21 Zeilen, 2 Spalten
2025-09-29 18:52:33,773 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,781 - INFO -   Validiere data/raw/order_products__prior.csv gegen order_products__prior Schema...
2025-09-29 18:52:33,807 - INFO -     Geladen: 10000 Zeilen, 4 Spalten
2025-09-29 18:52:33,831 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,840 - INFO -   Validiere data/raw/order_products__train.csv gegen order_products__train Schema...
2025-09-29 18:52:33,872 - INFO -     Geladen: 10000 Zeilen, 4 Spalten
2025-09-29 18:52:33,902 - INFO -     [OK] Schema-Validierung erfolgreich
2025-09-29 18:52:33,919 - INFO - [OK] Alle CSV-Dateien haben die Schema-Validierung bestanden
2025-09-29 18:52:33,936 - INFO - 
2025-09-29 18:52:33,938 - INFO - Schema-√úbersicht:
2025-09-29 18:52:33,954 - INFO -   products: 4 Spalten
2025-09-29 18:52:33,999 - INFO -   departments: 2 Spalten
2025-09-29 18:52:34,041 - INFO -   order_products__prior: 4 Spalten
2025-09-29 18:52:34,055 - INFO -   orders: 7 Spalten
2025-09-29 18:52:34,079 - INFO -   aisles: 2 Spalten
2025-09-29 18:52:34,099 - INFO -   order_products__train: 4 Spalten
2025-09-29 18:52:34,104 - INFO - Completed schema_validation in 0.85s (memory change: +12.1 MB)
2025-09-29 18:52:34,135 - INFO - Starting data_quality_checks (initial memory: 117.1 MB)
2025-09-29 18:52:34,146 - INFO - Starte umfassende Datenqualit√§tspr√ºfungen...
2025-09-29 18:52:42,129 - INFO - Datenqualit√§tspr√ºfungen abgeschlossen
2025-09-29 18:52:42,129 - INFO -   Qualit√§tsbericht: data\quality_reports\data_quality_report_20250929_185242.json
2025-09-29 18:52:42,136 - INFO -   Qualit√§tsstatus: FAIL
2025-09-29 18:52:42,136 - INFO -   Verst√∂√üe gesamt: 1
2025-09-29 18:52:42,138 - INFO -   Hohe Schwere: 1
2025-09-29 18:52:42,138 - WARNING - WARNUNG: Kritische Datenqualit√§tsprobleme gefunden!
2025-09-29 18:52:42,138 - WARNING - Pr√ºfe den Qualit√§tsbericht vor dem Fortfahren.
2025-09-29 18:52:42,138 - WARNING - Verwende --skip-quality-checks um zu √ºberspringen (nicht empfohlen)
2025-09-29 18:52:42,138 - INFO - Completed data_quality_checks in 7.99s (memory change: +9.1 MB)
2025-09-29 18:52:42,140 - INFO - Starting sql_query_loading (initial memory: 126.3 MB)
2025-09-29 18:52:42,149 - INFO - SQL-Query geladen aus src/sql/01_build.sql
2025-09-29 18:52:42,149 - INFO - STRUCTURED_METRICS: {"timestamp": "2025-09-29T18:52:42.149358", "context": "sql_query_loaded", "metrics": {"file_path": "src/sql/01_build.sql", "query_length_chars": 13107, "query_lines": 327}}
2025-09-29 18:52:42,149 - INFO - Completed sql_query_loading in 0.01s (memory change: +0.0 MB)
2025-09-29 18:52:42,151 - INFO - Idempotency check for feature_engineering: Inputs are newer than outputs, execution needed
2025-09-29 18:52:42,151 - INFO - Executing feature engineering: inputs_newer_than_outputs
2025-09-29 18:52:42,152 - INFO - Starting feature_engineering (initial memory: 126.3 MB)
2025-09-29 18:52:42,152 - INFO - Starte Feature Engineering mit DuckDB...
2025-09-29 18:52:42,152 - WARNING - File operation will overwrite existing data: CREATE data/features/features.parquet
2025-09-29 18:52:42,153 - WARNING - File operation: CREATE data/features/features.parquet (existing file, 147,685,519 bytes, modified 2025-09-29 17:43:53) - OVERWRITING EXISTING DATA at 2025-09-29 18:52:42
2025-09-29 18:52:42,164 - INFO - DuckDB Verbindung hergestellt
2025-09-29 18:52:42,164 - INFO - F√ºhre SQL Feature Engineering aus...
2025-09-29 18:52:42,164 - INFO -   - Lese CSV-Dateien aus data/ Verzeichnis
2025-09-29 18:52:42,164 - INFO -   - Trenne Prior/Train Daten (Data Leakage Prevention)
2025-09-29 18:52:42,164 - INFO -   - Berechne User-Product Interaction Features
2025-09-29 18:52:42,164 - INFO -   - Berechne Recency Features
2025-09-29 18:52:42,164 - INFO -   - Berechne Product Popularity Features
2025-09-29 18:52:42,164 - INFO -   - F√ºge Categorical Features hinzu
2025-09-29 18:52:42,164 - INFO -   - Generiere Labels aus Train Data
2025-09-29 18:52:49,872 - INFO - [OK] SQL Feature Engineering abgeschlossen in 7.71 Sekunden
2025-09-29 18:52:49,872 - INFO - Exportiere Ergebnis nach data/features/features.parquet...
2025-09-29 18:53:06,525 - INFO - [OK] Parquet-Export abgeschlossen
2025-09-29 18:53:08,303 - INFO - [OK] Output-Validierung:
2025-09-29 18:53:08,303 - INFO -   - Anzahl Zeilen: 8,474,661
2025-09-29 18:53:08,303 - INFO -   - Anzahl Spalten: 15
2025-09-29 18:53:08,303 - INFO -   - Schema:
2025-09-29 18:53:08,303 - INFO -     user_id: BIGINT
2025-09-29 18:53:08,304 - INFO -     product_id: BIGINT
2025-09-29 18:53:08,304 - INFO -     y: INTEGER
2025-09-29 18:53:08,304 - INFO -     times_bought: BIGINT
2025-09-29 18:53:08,304 - INFO -     times_reordered: DOUBLE
2025-09-29 18:53:08,304 - INFO -     user_prod_reorder_rate: FLOAT
2025-09-29 18:53:08,304 - INFO -     last_prior_ordnum: BIGINT
2025-09-29 18:53:08,304 - INFO -     orders_since_last: BIGINT
2025-09-29 18:53:08,304 - INFO -     avg_add_to_cart_pos: DOUBLE
2025-09-29 18:53:08,304 - INFO -     avg_days_since_prior: DOUBLE
2025-09-29 18:53:08,304 - INFO -     prod_cnt: BIGINT
2025-09-29 18:53:08,304 - INFO -     prod_users: BIGINT
2025-09-29 18:53:08,304 - INFO -     prod_avg_reorder_rate: DOUBLE
2025-09-29 18:53:08,304 - INFO -     aisle_id: BIGINT
2025-09-29 18:53:08,305 - INFO -     department_id: BIGINT
2025-09-29 18:53:08,352 - INFO - [OK] DuckDB Verbindung geschlossen
2025-09-29 18:53:08,352 - INFO - Completed feature_engineering in 26.20s (memory change: +74.1 MB)
2025-09-29 18:53:08,354 - INFO - Memory usage at completion: Process RSS=200.5MB (1.2% of system RAM), System: 5.2GB available (67.3% used)
2025-09-29 18:53:08,354 - INFO - ============================================================
2025-09-29 18:53:08,355 - INFO - DATASET BUILDING ERFOLGREICH ABGESCHLOSSEN!
2025-09-29 18:53:08,355 - INFO - ============================================================
2025-09-29 18:53:08,355 - INFO - Feature-Dataset erstellt: data/features/features.parquet
2025-09-29 18:53:08,355 - INFO - N√§chste Schritte:
2025-09-29 18:53:08,355 - INFO -   1. python src/train.py --model logreg
2025-09-29 18:53:08,355 - INFO -   2. python src/train.py --model xgb
2025-09-29 18:53:08,355 - INFO -   3. python src/train.py --model lgbm
2025-09-29 18:53:08,355 - INFO -   4. python src/report.py
2025-09-29 18:53:08,355 - INFO - Viel Erfolg beim ML-Training! üöÄ
